# 5주차 CS 발표

## Race Condition (경쟁 상태)

공유 자원에 대해 여러 프로세스가 동시에 접근할 때, 결과값에 영향을 줄 수 있는 상태

*동시 접근 시 자료의 일관성을 해치는 결과가 나타남*



### Critical Section(임계 영역)

병렬 프로그래밍에서 둘 이상의 스레드(멀티 스레드)가 동시에 접근해서는 안되는 공유 자원(파일, 입출력, 공유 데이터 등)을 접근하는 명령문 또는 코드의 일부 영역을 말함

병렬 프로그래밍에서  A라는 스레드가 공유 데이터의 값 변경을 시도하는 순간 B라는 스레드가 그 값을 읽는다면 그 값이 변경된 값인지 변경되기 전 값인지 예측할 수 없음.

이러한 문제로 동기화 처리(synchronized)를 반드시 해줘야하며, 임계 영역에 실행되는 스레드는 lock을 획득하게 되는데 이 lock은 오직 하나의 스레드만 가질 수 있음.



### Race Condition이 발생하는 경우

1. **커널 작업을 수행하는 중에 인터럽트 발생**
   - 문제점 : 커널 모드에서 데이터를 로드하여 작업을 수행하다가 인터럽트가 발생하여 같은 데이터를 조작하는 경우
   - 해결법 : 커널모드에서 작업을 수행하는 동안, 인터럽트를 disable 시켜 CPU 제어권을 가져가지 못하도록 함
2. **프로세스가 'System Call'을 하여 커널 모드로 진입하여 작업을 수행하는 도중 문맥 교환이 발생할 때**
   - 문제점 : 프로세스1이 커널 모드에서 데이터를 조작하는 도중, 시간이 초과되어 CPU 제어권이 프로세스2로 넘어가 같은 데이터를 조작하는 경우 (프로세스2가 작업에 반영되지 않음)
   - 해결법 : 프로세스가 커널모드에서 작업을 하는 경우 시간이 초과되어도 CPU 제어권이 다른 프로세스에게 넘어가지 않도록 함
3. **멀티 프로세서 환경에서 공유 메모리 내의 커널 데이터에 접근할 때**
   - 문제점 : 멀티 프로세서 환경에서 2개의 CPU가 동시에 커널 내부의 공유 데이터에 접근하여 조작하는 경우
   - 해결법 : 커널 내부에 있는 각 공유 데이터에 접근할 때마다, 그 데이터에 대한 lock/unlock을 하는 방법



### Race Condition 해결을 위한 충족 조건 3가지

- **Mutual Exclusion (상호 배제)</br>**
  어떤 프로세스가 임계 영역을 수행 중이면 다른 모든 프로세스들은 그 임계 영역에 들어가지 못하게 막는 것
- **Progress (진행)</br>**
  임계 영역에 들어간 프로세스가 있지 않은 상태에서 임계 영역에 들어가려는 프로세스가 있으면 들어가게 해주어야함. 즉, 임계 영역에 있는 프로세스 외에는 다른 프로세스가 임계 영역에 진입하는것을 방해하면 안됨
- **Bounded Waiting (한정 대기)</br>**
  기아(starvation) 상태를 방지하기 위해 프로세스가 임계 영역에 들어가려고 요청한 후부터 다른 프로세스들이 임계 영역에 들어가는 횟수에 한계가 있어야함. 임계 영역에 한 번 들어갔다 나온 프로세스는 다음에 들어갈 때 제한을 줌.

---

[참고 1] : <https://gyoogle.dev/blog/computer-science/operating-system/Race%20Condition.html>

[참고 2] : <https://hun-developer.tistory.com/36>

[참고 3] : <https://zangzangs.tistory.com/115?category=458016>


