### 싱글톤 패턴이란?

- 인스턴스를 불필요하게 생성하지 않고 오직 한 개의 인스턴스만 생성하여 사용하는 디자인 패턴
- 생성자의 호출이 반복적으로 이루어져도 실제로 생성되는 객체는 최초 생성된 객체를 반환



### 사용 이유

- 메모리 낭비 방지
- 이미 생성된 인스턴스를 활용함으로써 속도 상승
- 전역성을 띄기 때문에 클래스간 데이터 공유 쉬움



### 문제점

- 구현 코드가 많이 필요
- 정적 메서드에서 객체 생성을 체크하고 생성자를 호출하는 경우에 멀티스레딩 환경에서 발생할 수 있는 동시성 문제 해결하기 위한 코드도 필요
- 테스트 하기 어려움. 자원을 공유하기 때문에 테스트시 매번 인스턴스 상태 초기화 필요



### 싱글톤 패턴 구현 방식

1. Lazy initialization(늦은 초기화) 싱글톤 패턴

![image](https://user-images.githubusercontent.com/44665707/171619952-11617155-17bb-42d8-be41-4f1a9961fff1.png)

- static한 자기자신의 클래스를 필드로 만들고, 인스턴스가 필요하여 요청할 때 생성되는 형태
- private 생성자와 static 메서드를 사용한 가장 보편적인 방식
- 멀티쓰레드 환경에서 취약

2. synchronized 추가해 멀티 쓰레드 환경에서 안전하게 구현

![image](https://user-images.githubusercontent.com/44665707/171620905-242d9b80-0c81-49d8-ace7-ae460d3d73d7.png)

- 쓰레드 동기화 문제의 가장 쉬운 해결방법은 synchronized 키워드
- 하지만 이 방법은 매번 인스턴스를 리턴 받을 때마다 쓰레드를 동기화하기 때문에 성능 저하 발생



3. Eager initialization 싱글톤 패턴

![image](https://user-images.githubusercontent.com/44665707/171622038-9e6f4f21-ef1c-4129-966f-e577709203ea.png)

- 멀티 쓰레드 환경에서 유발되는 모든 문제를 해결
- 쓰레드가 getInstance()를 호출하는 시점이 아닌, Class가 로딩되는 시점. 즉, static 영역의 데이터 로딩시점에 인스턴스를 생성하기 때문에 하나의 인스턴스만 생성되는 것을 보장
- Thread-safe하며 소스도 간결하고 성능이 좋음
- 인스턴스를 미리 만들어 놓기 떄문에 만약 사용하지 않게 되면 메모리 낭비 발생

4. DCL(Double Checked Locking) 싱글톤 패턴

![image](https://user-images.githubusercontent.com/44665707/171622354-b8c8b931-c75d-45a9-83b5-1ea27708f4f8.png)

- static 필드에 volatile 키워드를 써야 자바 1.5 이상부터 동작
- 상당히 안정적이고 문제가 없는 방법

5. Lazy Holder 싱글톤 패턴

![image](https://user-images.githubusercontent.com/44665707/171622608-648eaac8-2f3f-4a3a-8eb0-0a6a1ba52d86.png)

- 현 시점에서 가장 완벽하다고 평가받는 방법
- Java 버전과도 상관없고 성능 뛰어남
- Lazy initialization 방식을 가져다 쓰면서 쓰레드간 동기화문제도 동시에 해결
- volatile이나 synchronized 같은 추가 키워드 없어도 Thread-safe함

