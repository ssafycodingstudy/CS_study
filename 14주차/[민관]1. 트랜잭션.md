### 트랜잭션이란?

- 쪼개질 수 없는 업무처리의 단위를 의미

> ATM으로 계좌이체를 한다고 생각,
>
> 1. A은행에서 B은행으로 송금하려고 함
> 2. 송금 중, 알수없는 오류로 인해 A은행 계좌에서 돈은 빠졌지만 B은행 계좌에 입금은 안됨
> 3. 이와 같은 상황 방지 위해 거래가 성공적으로 모두 끝나야 이를 완전한 거래로 승인하고, 거래 도중 오류가 발생했을 때는 거래를 처음부터 없엇던 거래로 완전히 되돌려야 함

- 위와 같은 상황에서 거래의 안정성을 확보하는 방법이 트랜잭션, DB에서 처리 과정이 모두 성공했을 때만 최종적으로 반영
- 2자기 명령어를 통해 트랜잭션 처리
  - 커밋 : 모든 부분작업이 정상적으로 완료하면 변경사항을 한꺼번에 DB에 반영
  - 롤백 : 부분 작업이 실패하면 트랜잭션 실행 전으로 되돌림. 모든 연산을 취소하지 않고 정해진 부분까지만 되돌리고 싶을때는 savepoint 활용
  - savepoint : SAVEPOINT 세이브포인트이름; 으로 저장해놓은뒤 ROLLBACK TO 세이브포인트 이름으로 savepoint 까지만 ROLLBACK 시킴



### 트랜잭션의 개념과 연산 과정

![image-20220410185815534](C:\Users\zoog1\AppData\Roaming\Typora\typora-user-images\image-20220410185815534.png)

- 활성(Active) : 트랜잭션이 정상적으로 실행중인 상태
- 실패(Failed) : 트랜잭션 실행에 오류가 발생해 중단된 상태
- 철회(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산 수행한 상태
- 부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전 상태
- 완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태



### 트랜잭션의 특징

- 원자성(Atomicity) : 트랜잭션이 DB에 모두 반영되거나, 혹은 전혀 반영되지 않아야 한다.
- 일관성(Consistency) : 트랜잭션의 작업 처리 결과는 항상 일관성이 있어야 한다.
- 독립성(Isolation) : 둘 이상의 트랜잭션이 동시에 병행 실행되고 잇을 때, 어떤 트랜잭션도 다른 트랜잭션 연산에 끼어들 수 없다.
- 영속성(Durability) : 트랜잭션이 성공적으로 완료 됐으면 결과는 영구적으로 반영돼야 한다.

