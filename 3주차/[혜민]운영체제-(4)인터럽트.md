# 3주차 CS 발표

## 인터럽트 (Interrupt)

### 인터럽트란?

프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 현재 실행 중인 작업을 즉시 중단하고, 발생된 상황에 대한 우선 처리가 필요함을 CPU에게 알리는것

지금 수행중인 일보다 더 중요한 일(ex. 입출력, 우선 순위 연산 등)이 발생하면 그 일을 먼저 처리하고 나서 하던 일을 계속 해야함

인터럽트는 크게 하드웨어 인터럽트와 소프트웨어 인터럽트로 나뉨



#### 하드웨어 인터럽트

하드웨어가 발생시키는 인터럽트로, CPU가 아닌 다른 하드웨어 장치가 CPU에 어떤 사실을 알려주거나 CPU 서비스를 요청해야 할 경우 발생시킴



#### 소프트웨어 인터럽트

소프트웨어가 발생시키는 인터럽트. 소프트웨어(사용자 프로그램)가 스스로 인터럽트 라인을 세팅함
종류 : 예외 상황, system call



인터럽트를 발생시키기 위해 하드웨어/소프트웨어는 CPU내에 있는 **인터럽트 라인** 을 세팅하여 인터럽트를 발생시킴

CPU는 매번 명령을 수행하기 전에 인터럽트 라인이 세팅되어있는지를 검사



### 인터럽트 과정

process A 실행 중 디스크에서 어떤 데이터를 읽어오라는 명령을 받았다고 가정

- process A는 `system call` 을 통해 인터럽트를 발생
- CPU는 현재 진행중인 기계어 코드를 완료
- 현재까지 수행중이었던 상태를 해당 process의 **PCB(Process Control Block)**에 저장
  (수행중이던 memory 주소, 레지스터 값, 하드웨어 상태 등)
- PC(Program Conter, IP)에 다음에 실행할 명령의 주소를 저장함
- 인터럽트 벡터를 읽고 ISR 주소값을 얻어 **ISR(Interrupt Service Routine)** 로 점프하여 루틴을 실행함
  *인터럽트 벡터 : 인터럽트 발생 시 처리해야 할 인터럽트 핸들러의 주소를 인터럽트 별로 보관하고있는 테이블*
- 해당 코드를 실행
- 해당 일을 다 처리하면, 대피시킨 레지스터를 복원함
- ISR의 끝에 IRET 명령어에 의해 인터럽트가 해제됨
- IRET 명령어가 실행되면, 대피시킨 PC값을 복원하여 이전 실행 위치로 복원

![img](https://mblogthumb-phinf.pstatic.net/20160310_124/scw0531_14575366291105WjS7_PNG/ERTRTETRE.png?type=w2)



만약 인터럽트 기능이 없었다면, 컨트롤러는 특정한 어떤 일을 할 시키를 알기 위해 계속 체크를 해야함 (이를 **폴링(Polling)** 이라고 함)
폴링을 하는 시간에는 원래 하던 읽에 집중할 수가 없게 되어 많은 기능을 제대로 수행하지 못하는 단점이 있었음



컨트롤러가 입력을 받아들이는 방법(우선순위 판별방법)에는 폴링과 인터럽트 방식이 있음
둘의 차이는 **이벤트를 기다리는 방식**

##### 폴링 방식

사용자가 명령어를 사용해 입력핀의 값을 계속 읽어 변화를 알아내는 방식 (정기적으로 상태를 조사하는 방식)

##### 인터럽트 방식

마이크로컨트롤러(MCU) 자체가 하드웨어적으로 변화를 체크하여 변화 시에만 일정한 동작을 하는 방식

- **Daisy Chain (직렬 우선순위 부여 방식)**

  인터럽트가 발생하는 모든 장치를 한 개의 회선에 직렬로 연결하며 우선순위가 높은 장치를 맨 앞에 위치시켜서 우선 순위에 따라 연걸함

- **병렬 우선순위 부여**

  각 장치마다 별개의 회선으로 연결

  

인터럽트 방식은 하드웨어로 지원을 받아야하는 제약이 있지만, 폴링에 비해 신속하게 대응하는 것이 가능함.
따라서 **실시간 대응** 이 필요할 때는 필수적인 기능
즉, 인터럽트는 **발생 시기를 예측하기 힘든 경우에 컨트롤러가 가장 빠르게 대응할 수 있는 방법**



---

[참고 1] : <https://velog.io/@adam2/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8>

[참고 2] : <https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/Interrupt.md>

[참고 3] : https://velog.io/@nayoon-kim/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-3%EC%9E%A5




