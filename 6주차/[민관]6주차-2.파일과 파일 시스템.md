### 파일과 파일 시스템

- 파일은 논리적인 저장 단위, 관련된 정보 자료들의 집합에 이름 붙인 것
- 파일 속성(File attribute), 파일 메타데이터(metadata)는 파일을 관리하기 위한 각종 정보
- 파일 시스템은 운영체제와 모든 데이터, 프로그램의 저장과 접근을 위한 기법을 제공
- 파티션은 연속된 저장 공간을 하나 이상의 연속되고 독립적인 영역으로 나누어 사용할 수 있도록 정의한 것



### 접근 방법

1. 순차 접근(Sequential Access)

   - 가장 단순한 방법으로 파일의 정보가 레코드 순서대로 처리, 카세트테이프 사용 방식과 동일
   - 현재 위치에서 읽거나 쓰면 offset이 자동으로 증가, 뒤로 돌아가기 위해선 되감기가 필요

   ![2](https://user-images.githubusercontent.com/44665707/151326263-e20d109f-4738-4bf1-88ce-521bd7b3b394.PNG)

2.  직접 접근(Random Access)

   - 파일의 레코드를 임의의 순서대로 접근할 수 있음. LP판을 사용하는 방식과 동일
   - 읽기나 쓰기의 순서에 제약이 없으며 현재 위치를 유지할 수 있다면 이를 통해 순차 접근 기능도 구현



3.  색인 접근(Index Access)

   - 파일에서 레코드를 찾기 위해 색인을 먼저 찾고 대응되는 포인터 얻음
   - 이를 통해 파일에 직접 접근하여 원하는 데이터를 얻을 수 있음
   - 크기가 큰 파일에 유용

   ![3](https://user-images.githubusercontent.com/44665707/151326491-feb23ac2-0ab1-4576-ad4c-b993de68d3c9.PNG)

### 디렉터리

- 파일의 메타데이터 중 일부를 보관하고 있는 일종의 특별한 파일
- 파일 찾기, 생성, 삭제, 재명명 등의 기능을 제공
- 디렉터리의 파일을 빠르게 탐색 가능해야함. 이를 위해 디렉터리의 논리적 구조를 정의하는 여러 방법 존재



1. 1단계 디렉터리(Single-Level Directory)

   - 모든 파일들이 디렉터리 밑에 존재하는 형태, 같은 이름 사용 불가
   - 파일이 많아지거나 다수의 사용자가 사용하는 시스템에서는 심각한 제약 발생

   ![4](https://user-images.githubusercontent.com/44665707/151326802-e4bdf1b7-da17-4d29-beb7-06f2e04860aa.PNG)

2.  2단계 디렉터리(Two-Level Directory)

   - 각 사용자별로 별도의 디렉터리를 갖는 형태

   - UFD(User File Directory) : 자신만의 사용자 파일 디렉터리
   - MFD(Master File Directory) : 사용자의 이름과 계정 번호로 색인되어 있는 디렉터리
   - 서로 다른 사용자가 같은 이름 파일 가질 수 있고 효율적 탐색 가능
   - 그룹화는 불가능하고 다른 사용자의 파일에 접근해야 하는 경우 단점 발생

   ![5](https://user-images.githubusercontent.com/44665707/151326949-6dc3218f-777f-4eb1-80bd-2ab7e686004a.PNG)

   

3. 트리 구조 디렉터리(Tree-Structured Directory)

   - 사용자들이 자신의 서브 디렉터리를 만들어 파일 구성 가능
   - 효율 적 탐색 가능하고, 그룹화 가능

   ![6](https://user-images.githubusercontent.com/44665707/151327464-e7909de7-03d4-47a2-b05d-08eeec1cef17.PNG)

   

4.  비순환 그래프 디렉터리(Acyclic-Graph Directory)

   - 디렉터리들이 서브 디렉터리들과 파일을 공유 할 수 있음
   - 트리 구조의 디렉터리를 일반화한 형태
   - 참조 계수를 둬서, 참조 계수가 0일때만 삭제할 수 있도록함

   ![7](https://user-images.githubusercontent.com/44665707/151337966-cd7a40b1-6b18-4af6-b4a0-60cd3f739215.PNG)

   

5. 일반 그래프 디렉터리(General Graph Directory)

   - 순환을 허용하는 그래프 구조
   - 하위 디렉터리가 아닌 파일에 대한 링크만 허용하거나 G.C를 통해 전체 파일 시스템을 순회통해 무한 루프 방지

   ![8](https://user-images.githubusercontent.com/44665707/151338152-bf55c300-d1fb-464a-86db-02da5dc6cbd4.PNG)

   

   

   



### 파일 데이터 할당(Allocation)

1. 연속 할당(Contiguous Allocation)

   - 파일을 디스크에 연속되게 저장하는 방식
   - 디렉터리에는 파일 시작 부분의 위치와 파일의 길이에 대한 정보 저장해 전체 탐색 가능
   - 한번의 탐색에 많은 양 전송 가능, Random Access 가능
   - 외부 단편화 발생 및 파일의 크기 키우기 어려움
   - 그렇다고 커질 가능성 고려해 미리 큰 공간을 할당하면 내부 단편화 발생 가능

2. 연결 할당(Linked Allocation)

   - 연속적으로 할당하지 않고 빈 위치면 자유롭게 할당 가능, 다음 읽어야 할 위치를 연결 리스트처럼 포인터로 기리킴
   - 디렉터리에는 파일 시작 위치와 끝나는 위치만 저장
   - 한 sector가 고장 나 포인터가 유실되면 많은 부분을 잃게 될 수 있음
   - 이 단점 보완위해 FAT(File-allocation table)이라는 파일 시스템 사용, 포인터를 별도 위치에 보관함

3. 색인 할당(Indexed Allocation)

   - 한 블록에 하나의 파일에 대한 데이터의 index들을 모두 저장, 디렉터리에는 해당 블록 위치만 담김

   

   