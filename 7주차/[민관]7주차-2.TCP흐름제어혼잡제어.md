### TCP

- 일반적으로 TCP와 IP를 함께 사용하는데, IP가 데이터의 배달을 처리한다면 TCP는 패킷을 추적 및 관리
- 신뢰성 있는 데이터 전송을 지원하는 연결 지향형 프로토콜
- 사전에 3-way Handshake 과정 통해 연결을 설정하고 통신을 시작
- 4-way Handshake 과정 통해 연결을 해제
- 흐름 제어, 혼잡 제어, 오류 제어를 통해 신뢰성을 보장, 이 때문에 UDP보다는 전송 속도가 느림
- 데이터의 전송 순서를 보장하며 수신 여부 확인 가능
- TCP를 사용하는 예로는 대부분의 웹 HTTP 통신, 이메일, 파일 전송
- TCP가 가상회선 방식을 제공한다는 것은 송수신측과 수신측을 연결하여 패킷을 전송하기 위한 논리적 경로 배정한다는 뜻



### 패킷(Packet)이란?

- 인터넷 내에서 데이터를 보내기 위한 경로 배정(라우팅)을 효율적으로 하기 위해서 데이터를 여러 개의 조각으로 나누어 전송을 하는데, 이때의 조각을 패킷이라고 함



### TCP는 패킷을 어떻게 추적 및 관리 하는지?

- 데이터는 패킷 단위로 나누어 같은 목적지(Ip 계층)으로 전송

- 각각의 패킷에 번호를 부여하여 수신측에 전부 제대로 도착햇을 때 하나의 데이터로 재조립



### 흐름 제어

- 송,수신측 사이의 데이터 처리 속도 차이(흐름)을 해결하기 위한 기법
- 송신측의 전송량 > 수신측의 수신량일 경우 패킷이 손실될수 있기 때문에 송신측 패킷 전송량을 제어



1. Stop and Wait(정지-대기)
   - 매번 전송한 패킷에 대한 확인 응답을 받아야 그 다음 패킷 전송 가능
   - 비효율적
2. Sliding Window(슬라이딩 윈도우)
   - 수신측에서 설정한 윈도우 크기만큼 송신측에서 확인 응답 없이 세그먼트를 전송할 수 있게 하여 데이터 흐름을 동적으로 조절하는 기법
   - 윈도우 : 송, 수신 스테이션 양쪽에서 만들어진 버퍼의 크기
   - Stop and Wait의 비효율성 개선
   - 송신측에서는 ACK 프레임을 수신하지 않더라도 여러 개의 프레임을 연속적으로 전송 가능
   - 송신측에서 0,1,2,3,4,5,6을 보낼 수 있는 프레임을 가지고 있고 데이터는 0,1을 전송했다고 가정하면 슬라이딩 윈도우 구조는 2,3,4,5,6으로 변함
   - 수신측에서 ACK 프레임을 보내주면 송신측이 이전에 보낸 데이터 0,1 이 제대로 도착했음을 인지하고 슬라이딩 윈도우는 ACK 프레임의 수만큼 오른쪽으로 경계가 확장



### 오류 제어

- 오류 검출과 재전송을 포함
- ARQ(Automatic Repeat Request) 기법을 사용해 프레임이 손상됐거나 손실됐을 경우, 재전송 통해 오류 복구
- ARQ 기법은 흐름 제어 기법과 연관



1. Stop and Wait ARQ

   - 송신측에서 1개의 프레임을 송신, 수신측에서 수신된 프레임의 에러 유무 판단해 ACK 혹은 NAK 보냄
   - 식별 위해 데이터 프레임과 ACK 프레임은 각각 0,1 번호를 번갈아가며 부여
   - 수신측이 데이터를 받지 못했을 경우 NAK를 보내고 NAK를 받은 송신측은 데이터를 재전송
   - 만약 데이터나 ACK가 분실되면 일정 간격 시간 두고 타팀아웃 되어 송신측은 데이터를 재전송

2. Go-Back-n ARQ(슬라이딩 윈도우)

   - 전송된 프레임이 손상되거나 분실된 경우, ACK 패킷 손실 인한 TIME_OUT 발생한 경우, 마지막 프레임 이후의 모든 프레임을 재전송
   - 슬라이딩 윈도우는 연속적인 프레임 전송 기법으로 전송측은 전송된 프레임의 복사본을 가지고 있어야 하며, ACK와 NAK 모두 각각 구별해야 함

3. SR(Selective-Reject) ARQ

   - GBn ARQ의 확인된 마지막 프레임 이후의 모든 프레임을 재전송하는 단점을 보완하는 기법
   - SR ARQ는 손상된, 손실된 프레임만 재전송
   - 그렇기 때문에 별도의 데이터 재정렬을 수행해야 하며, 별도의 버퍼를 필요로 함
   - 수신측에 버퍼를 두어 받은 데이터의 정렬이 필요

   

### 혼잡 제어

- 송신측의 데이터 전달과 네트워크의 데이터 처리 속도를 해결하기 위한 기법

- 한 라우터에 데이터가 몰려 들어 모든 데이터를 처리할 수 없는 경우, 호스트들은 재전송을 하게 되고 결국 혼잡만 가중시켜 오버플로우나 데이터 손실이 발생
- 이러한 네트워크 혼잡 피하기 위해 송신측에서 보내는 데이터의 전송 속도를 제어 하는 것



1. AIMD (Addtive Increase Multicative Decrease)

   - 합 증가 / 곱 감소 알고리즘
   - 처음에 패킷 하나를 보내는 것으로 시작하여 전송한 패킷이 문제 없이 도착한다면 윈도우 사이즈를 1씩 증가시키며 전송시키는 방법. 패킷 전송 실패하거나 TIME_OUT 발생하면 윈도우 사이즈를 절반으로 감소
   - 초기 네트워크의 높은 대역폭을 사용하지 못하고, 혼잡해지고 나서야 대역폭을 줄이는 방식

2. Slow Start

   - AIMD가 네트워크 수용량 주변에서는 효율적으로 동작하지만, 처음에는 전송 속도를 올리지 못함
   - 패킷을 하나씩 보내며 시작. ACK 패킷마다 윈도우 사이즈를 1씩 늘림. 한 주기가 지나면 윈도우 사이즈는 2배가 될 것
   - 혼잡 현상 발생하면 윈도우 사이즈를 1로 떨어뜨림

   - 혼잡 현상이 발생하였던 윈도우 사이즈의 얼반까지는 지수 함수 꼴로 증가시키고, 그 이후부터는 1씩 증가